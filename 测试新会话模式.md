# 测试新会话模式

## 🎯 测试目标

验证会话模式下的自动连续录音功能是否正常工作。

## 🚀 快速测试步骤

### 1. 启动应用

```bash
cd english-conversation-trainer
npm start
```

等待浏览器自动打开 http://localhost:3000

### 2. 开始对话

1. 看到蓝色麦克风按钮
2. 点击按钮
3. **验证**：
   - ✅ 按钮变为红色停止按钮
   - ✅ 提示变为"🎤 正在录音..."
   - ✅ 可以开始说话

### 3. 第一轮对话

1. 说一句话，例如："Hello, how are you?"
2. 等待自动识别（说完一句完整的话后会自动提交）
3. **验证**：
   - ✅ 提示变为"正在处理..."
   - ✅ 然后变为"考拉正在说话..."
   - ✅ AI开始回复

### 4. 第二轮对话（关键测试）

1. 等待AI说完
2. **验证**：
   - ✅ AI说完后，提示自动变为"🎤 正在录音..."
   - ✅ 无需点击任何按钮
   - ✅ 可以直接说下一句话

3. 说第二句话，例如："I'm fine, thank you!"
4. **验证**：
   - ✅ 自动识别并提交
   - ✅ AI再次回复

### 5. 持续对话

重复步骤4，测试3-5轮对话，确保每次都能自动录音。

### 6. 结束对话

1. 点击红色停止按钮
2. **验证**：
   - ✅ 显示"正在处理..."
   - ✅ 弹出提示"对话已保存到历史记录！"
   - ✅ 按钮变回蓝色麦克风

### 7. 查看历史

1. 左侧历史面板应该显示刚才的对话
2. 点击历史记录
3. **验证**：
   - ✅ 打开详情弹窗
   - ✅ 显示完整对话内容
   - ✅ 显示AI生成的摘要

## ✅ 成功标准

如果以下所有项都通过，说明功能正常：

- [ ] 点击开始后自动开始录音
- [ ] 第一句话能正常识别
- [ ] AI回复后自动开始下一次录音（**最关键**）
- [ ] 可以连续说3-5句话，每次都自动录音
- [ ] 点击结束后正常保存
- [ ] 历史记录可以查看

## ❌ 常见问题

### 问题1：AI回复后没有自动开始录音

**可能原因**：
- 浏览器控制台有错误
- 麦克风权限被拒绝

**解决方案**：
1. 打开浏览器控制台（F12）
2. 查看是否有错误信息
3. 检查麦克风权限
4. 刷新页面重试

### 问题2：录音一直不停止

**可能原因**：
- 环境噪音太大
- 没有检测到句子结束

**解决方案**：
1. 说完一句话后停顿1-2秒
2. 确保环境安静
3. 说完整的句子（有明确的结束）

### 问题3：对话没有保存

**可能原因**：
- 没有点击"结束对话"按钮
- localStorage被禁用

**解决方案**：
1. 确保点击红色停止按钮
2. 检查浏览器设置，允许localStorage
3. 至少要有一条消息才会保存

## 🔍 调试技巧

### 查看控制台日志

打开浏览器控制台（F12），查看以下日志：

```
[App] Auto-stop triggered by sentence detection  // 自动停止录音
[App] Auto-stop processing...                    // 开始处理
💾 Conversation saved: session-xxxxx             // 对话已保存
```

### 检查状态

在控制台输入以下命令查看当前状态：

```javascript
// 查看localStorage中的对话历史
JSON.parse(localStorage.getItem('english-trainer-conversation-history'))

// 查看设置
JSON.parse(localStorage.getItem('english-trainer-settings'))
```

## 📊 性能测试

### 测试场景1：快速对话

1. 开始对话
2. 快速说5句话（每句话间隔2-3秒）
3. 验证每次都能正常识别

### 测试场景2：慢速对话

1. 开始对话
2. 每句话间隔10-15秒
3. 验证录音状态保持正常

### 测试场景3：长对话

1. 开始对话
2. 持续对话10-15轮
3. 验证性能没有下降
4. 验证保存的历史记录完整

## 🎉 测试完成

如果所有测试都通过，恭喜！新的会话模式已经完美运行。

现在你可以享受流畅的英语对话练习了！

## 📝 反馈

如果发现任何问题，请记录：

1. 问题描述
2. 复现步骤
3. 浏览器控制台的错误信息
4. 浏览器版本和操作系统

这将帮助快速定位和解决问题。
