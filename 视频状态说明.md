# 考拉视频状态系统

## 视频文件
项目中有4个考拉状态视频，位于 `/public` 文件夹：

1. **koala.mp4** - 默认/空闲状态
2. **koala-listening.mp4** - 录音/倾听状态
3. **koala-thinking.mp4** - 处理/思考状态
4. **koala-speaking.mp4** - 说话状态

## 状态切换逻辑

视频会根据应用状态自动切换：

| 应用状态 | 视频文件 | 触发条件 |
|---------|---------|---------|
| 空闲 (idle) | koala.mp4 | 默认状态，没有录音/处理/说话 |
| 倾听 (listening) | koala-listening.mp4 | `isRecording = true` (用户按住按钮说话) |
| 思考 (thinking) | koala-thinking.mp4 | `isProcessing = true` (Whisper正在识别) |
| 说话 (speaking) | koala-speaking.mp4 | `isSpeaking = true` (AI正在播放语音) |

## 优先级

当多个状态同时为 true 时，按以下优先级选择视频：
1. **录音** (isRecording) - 最高优先级
2. **处理** (isProcessing)
3. **说话** (isSpeaking)
4. **空闲** (默认)

## 实现细节

- 使用 `useEffect` 监听 `isRecording`, `isProcessing`, `isSpeaking` 三个状态
- 桌面端和移动端各有独立的视频元素引用
- 视频切换时会自动 `load()` 和 `play()`
- 添加了 console.log 用于调试状态切换

## 调试

打开浏览器控制台，可以看到类似日志：
```
[Video] State changed to: listening, video: /koala-listening.mp4
[Video] Desktop - Switching from /koala.mp4 to /koala-listening.mp4
```

## 测试步骤

1. **空闲状态**: 打开应用，应该看到 koala.mp4
2. **倾听状态**: 按住麦克风按钮，应该切换到 koala-listening.mp4
3. **思考状态**: 松开按钮，应该切换到 koala-thinking.mp4
4. **说话状态**: AI开始回复，应该切换到 koala-speaking.mp4
5. **返回空闲**: AI说完后，应该切换回 koala.mp4

## 故障排除

如果视频没有切换：
1. 检查浏览器控制台是否有错误
2. 确认4个视频文件都在 `/public` 文件夹
3. 检查视频文件是否损坏（能否单独播放）
4. 查看控制台日志确认状态是否正确触发
